---
title: 'STA457: Time Series Analysis'
subtitle: Assignment 1
date: "2025-01-24"
output:
  pdf_document: default
  html_document: default
---
\maketitle

\section{Question 1}
\subsection{1a) If the model is correct, what is the estimated average annual increase in E-
Commerce sales?}
```{r}
library(tidyverse)
library(stringr)

e_com_data <- read.csv('downloads/E-commerce.csv')


# mutating quarter column so only quarter number shows
e_com_data <- e_com_data |>
  mutate(
    Quarter = sub("^\\d{4} ", "", Quarter),
    t = 1:n()
  )

# creating indicator variables for each quarter

e_com_data <- e_com_data |>
  mutate(
    Q1 = ifelse(Quarter == "Q1", 1, 0),
    Q2 = ifelse(Quarter== "Q2", 1, 0),
    Q3 = ifelse(Quarter== "Q3", 1, 0),
    Q4 = ifelse(Quarter== "Q4", 1, 0)
  )

# creating a regression model
reg_model <- lm(Value ~ t + Q1 + Q2 + Q3 + Q4 - 1, data = e_com_data)

# calculating average annual increase in e-com sales
# since beta represents the increase per quarter, we need to multiply by 4

beta <- coef(reg_model)["t"]
annual_increase <- beta * 4
annual_increase

```
The estimated annual increase in E-commerce sales is 29,616.14

\subsection{1b) If the model is correct, does the average sales increase or decrease from the third
quarter to the fourth quarter? And, by what percentage does it increase or
decrease? (keep 3 decimal places)}
```{r}

coef <- coefficients(reg_model)

alpha_3 <- coef["Q3"]
alpha_4 <- coef["Q4"]

percent_change <- ((alpha_4 - alpha_3)/alpha_3) * 100
percent_change
```
There is a 41.206% increase from the third quarter to the fourth quarter

\subsection{1c) What happens if you include an intercept term in the model in (a)? Explain why
there was a problem.}
```{r}
# lets create a model with the intercept included and try to do part a and b again
int_inc_model <- lm(Value ~ t + Q1 + Q2 + Q3 + Q4, data = e_com_data)

# doing part a again
beta2 <- coef(int_inc_model)["t"]
annual_increase2 <- beta2 * 4
annual_increase2

# doing part b again
coef2 <- coefficients(int_inc_model)

a_3 <- coef2["Q3"]
a_4 <- coef2["Q4"]

percent_change2 <- ((a_4 - a_3)/a_3) * 100
percent_change2

```
From the above, we see that while the annual increase remains the same, the percent change is unable to be calculated as Q4 is returned as 'NA'. This is because when we include the intercept, due to the fact that there is high multicollinearity between the Quarters, it excludes one quarter from the model to compensate. This 


\section{Question 2}
```{r}



```

\section{Question 3}
```{r}



```

